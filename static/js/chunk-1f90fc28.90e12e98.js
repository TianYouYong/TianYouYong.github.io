(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f90fc28"],{"03ea":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.visable,"close-on-click-modal":!1,"before-close":e.cancel,"append-to-body":"",width:"750px"},on:{"update:visible":function(t){e.visable=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"刷新文件",prop:"freshFile"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择.dll文件",disabled:""},model:{value:e.form.freshFile,callback:function(t){e.$set(e.form,"freshFile",t)},expression:"form.freshFile"}}),e._v(" "),a("upload",{attrs:{"file-type":"dll","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"freshFile"},on:{getFile:e.getFile}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"秘钥文件",prop:"secretFile"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择.dll文件",disabled:""},model:{value:e.form.secretFile,callback:function(t){e.$set(e.form,"secretFile",t)},expression:"form.secretFile"}}),e._v(" "),a("upload",{attrs:{"file-type":"dll","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"secretFile"},on:{getFile:e.getFile}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"校验文件",prop:"checkFile"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择.dll文件",disabled:""},model:{value:e.form.checkFile,callback:function(t){e.$set(e.form,"checkFile",t)},expression:"form.checkFile"}}),e._v(" "),a("upload",{attrs:{"file-type":"dll","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"checkFile"},on:{getFile:e.getFile}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"校验值(十进制)",prop:"checkValue"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.form.checkValue,callback:function(t){e.$set(e.form,"checkValue",t)},expression:"form.checkValue"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"刷新通道",prop:"channel"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.form.channel,callback:function(t){e.$set(e.form,"channel",t)},expression:"form.channel"}},e._l(e.channelOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"数据文件",prop:"dataFile"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择",disabled:""},model:{value:e.form.dataFile,callback:function(t){e.$set(e.form,"dataFile",t)},expression:"form.dataFile"}}),e._v(" "),a("upload",{attrs:{"file-type":"dbc","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"dataFile"},on:{getFile:e.getFile}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请输入内容",type:"textarea",rows:5,maxlength:"30","show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}}),e._v(" "),a("el-button",{staticStyle:{width:"21%","vertical-align":"top"},attrs:{type:"primary",plain:""},on:{click:function(t){e.form.remark=""}}},[e._v("清除")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)},i=[],n=(a("7f7f"),a("ac6a"),a("456d"),a("c5f6"),a("7d4e")),l={name:"RemoteRefresh",components:{Upload:n["a"]},props:{visable:{default:!1,type:Boolean},id:{default:0,type:Number},currentInfo:{default:function(){return{}},type:Object}},data:function(){var e=this;return{title:"远程刷写",file:null,formData:new FormData,channelOptions:Object.keys(this.ENUMS.REFRESH_CHANNEL).map((function(t){return{value:t,label:e.ENUMS.REFRESH_CHANNEL[t]}})),form:{},rules:{freshFile:[{required:!0,message:"刷新文件不能为空",trigger:["blur","change"]}],secretFile:[{required:!0,message:"秘钥文件不能为空",trigger:["blur","change"]}],checkFile:[{required:!0,message:"校验文件不能为空",trigger:["blur","change"]}],checkValue:[{required:!0,message:"校验值不能为空",trigger:"blur"},{max:10,message:"校验值长度最多10个字符",trigger:"blur"},{pattern:/\d/,message:"检验值只能是数字",trigger:"blur"}],channel:[{required:!0,message:"请选择刷新通道",trigger:"change"}],dataFile:[{required:!0,message:"数据文件不能为空",trigger:["blur","change"]}]},queryParams:{pageNo:1,pageSize:10,deviceCode:""}}},created:function(){if(this.reset(),this.currentInfo&&this.currentInfo.id){var e=JSON.parse(JSON.stringify(this.currentInfo));this.form.id=e.id}},methods:{getFile:function(e,t){t&&(this.form[t]=e.name)},submitForm:function(){this.$refs["form"].validate((function(e){}))},reset:function(){this.form={id:void 0,deviceCode:"",freshFile:"",secretFile:"",checkFile:"",checkValue:"",channel:"",dataFile:""},this.resetForm("form")},cancel:function(){this.reset(),this.$emit("cancel")}}},o=l,s=a("2877"),c=Object(s["a"])(o,r,i,!1,null,"7c9f2b76",null);t["a"]=c.exports},"1d70":function(e,t,a){"use strict";a("2255")},2255:function(e,t,a){},3135:function(e,t,a){"use strict";a("5bd2")},"435f":function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"h",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return f})),a.d(t,"e",(function(){return d}));var r=a("b775"),i=(a("24bf"),a("f121"));function n(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device",method:"get",params:e})}function l(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device",method:"post",data:e})}function o(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device/".concat(e.id),method:"put",data:e})}function s(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device/".concat(e),method:"delete"})}function c(){return Object(r["a"])({url:i["a"].API_MONIT+"/device/recover-num",method:"get"})}function u(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device/decide-recover/".concat(e),method:"get"})}function f(e){return Object(r["a"])({url:i["a"].API_MONIT+"/logs",method:"get",params:e})}function d(e){return Object(r["a"])({url:i["a"].API_MONIT+"/device/status/"+e,method:"get"})}},"4d9e":function(e,t,a){},"5b24":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-autocomplete",{style:{width:e.width},attrs:{"value-key":"userName","popper-append-to-body":!1,"fetch-suggestions":e.querySearchAsync,"popper-class":e.state&&e.restaurants.length?"inputOption":"",size:e.size,debounce:0,clearable:"",placeholder:"请输入内容"},on:{blur:e.handleBlur,select:e.handleSelect,clear:e.handleClear},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})},i=[],n=a("c0c7"),l={name:"AutoComplete",props:{size:{default:"small",type:String},width:{default:"100%",type:String}},data:function(){return{restaurants:[],state:"",timeout:null}},methods:{querySearchAsync:function(e,t){var a=this;if(e){var r={keyword:e,active:!0};Object(n["m"])(r).then((function(r){if(r&&r.data&&200===r.code){a.restaurants=r.data;var i=a.restaurants,n=e?i.filter(a.createStateFilter(e)):i;clearTimeout(a.timeout),a.timeout=setTimeout((function(){t(n)}),0)}}))}else this.handleClear()},createStateFilter:function(e){return function(t){return 0===t.userName.toLowerCase().indexOf(e.toLowerCase())}},handleBlur:function(){var e=this;setTimeout((function(){if(e.state){var t=e.restaurants.filter((function(t){return t.userName===e.state}));t.length||(e.$message.warning("服务器中无此用户"),e.handleClear())}}),500)},handleSelect:function(e){this.$emit("autoValue",e)},handleClear:function(){this.state="",this.$emit("autoValue",this.state)}}},o=l,s=(a("3135"),a("2877")),c=Object(s["a"])(o,r,i,!1,null,"359a943f",null);t["a"]=c.exports},"5bd2":function(e,t,a){},"7ca7":function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"g",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"f",(function(){return f})),a.d(t,"c",(function(){return d}));var r=a("b775"),i=(a("24bf"),a("f121"));function n(){return Object(r["a"])({url:i["a"].API_MONIT+"/project/all",method:"get"})}function l(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project",method:"get",params:e})}function o(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project",method:"post",data:e})}function s(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project/".concat(e.id),method:"put",data:e})}function c(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project/stop/".concat(e.id),method:"put",data:e})}function u(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project/begin/".concat(e.id),method:"put",data:e})}function f(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project/over/".concat(e),method:"put"})}function d(e){return Object(r["a"])({url:i["a"].API_MONIT+"/project/".concat(e),method:"delete"})}},"7d4e":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-upload",{ref:"upload",staticStyle:{display:"inline"},attrs:{action:"1","file-list":e.fileList,"show-file-list":e.showFileList,"on-change":e.handleChange,"before-upload":e.beforeUpload,"http-request":e.handleUpload,"on-remove":e.handleRemove}},[a("el-button",{attrs:{slot:"trigger",type:"primary",size:e.btSize,plain:e.btPlain},slot:"trigger"},[e._v(e._s(e.btContent))])],1)},i=[],n=(a("28a5"),a("7f7f"),a("c5f6"),{name:"Upload",props:{fileType:{default:"",type:String},limitSize:{default:0,type:Number},showFileList:{default:!1,type:Boolean},btPlain:{default:!1,type:Boolean},btSize:{default:"small",type:String},btContent:{default:"选择文件",type:String},iptLabel:{default:"",type:String}},data:function(){return{file:null,fileList:[]}},created:function(){},methods:{handleChange:function(e,t){t.length>1&&(this.fileList=[t[t.length-1]])},beforeUpload:function(e){console.log("beforeUpload :>> ",e);var t=/[`()|（）]/;if(t.test(e.name))return this.$message.error("文件名中不能有括号，请修改后重新上传！"),!1;var a=e.name.split(".").splice(-1)[0].toUpperCase()===this.fileType.toUpperCase(),r=e.size/1024/1024<this.limitSize;return"any"===this.fileType&&(a=!0),a||this.$message.error("上传文件必须是".concat(this.fileType.toUpperCase(),"格式 !")),r||this.$message.error("上传文件大小不能超过".concat(this.limitSize,"MB !")),a&&r},handleUpload:function(e){this.file=e.file,this.$emit("getFile",this.file,this.iptLabel)},handleRemove:function(e,t){this.file=null,this.$emit("getFile",this.file,"")}}}),l=n,o=(a("1d70"),a("2877")),s=Object(o["a"])(l,r,i,!1,null,"c49edf50",null);t["a"]=s.exports},8889:function(e,t,a){"use strict";a.d(t,"g",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return f}));var r=a("b775"),i=(a("24bf"),a("f121"));function n(e){return Object(r["a"])({url:i["a"].API_FILE+"/file/upload/single",method:"post",data:e})}function l(e){return Object(r["a"])({url:i["a"].API_FILE+"/file-manage",method:"get",params:e})}function o(e){return Object(r["a"])({url:i["a"].API_FILE+"/device-config",method:"get",params:e})}function s(e){return Object(r["a"])({url:i["a"].API_MONIT+"/send-device",method:"post",data:e})}function c(e){return Object(r["a"])({url:i["a"].API_MONIT+"/send-device/again",method:"post",data:e})}function u(e){return Object(r["a"])({url:i["a"].API_FILE+"/device-file-upload/lastSendConfig",method:"get",params:e})}function f(e){return Object(r["a"])({url:i["a"].API_FILE+"/device-control/restart",method:"post",data:e})}},"992a":function(e,t){e.exports="data:image/png;base64,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"},"9fde":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:24}},[r("el-row",{staticClass:"headerBtnLine",attrs:{gutter:24}},[r("el-col",{staticClass:"clearfix"},[r("el-button",{attrs:{type:"primary",size:"mini",plain:"status"!==e.type},on:{click:function(t){return e.handleChange("status")}}},[e._v("设备状态\n        ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini",plain:"config"!==e.type},on:{click:function(t){return e.handleChange("config")}}},[e._v("配置文件\n        ")]),e._v(" "),r("router-link",{staticClass:"pull-right mt10 mr20 go-back",attrs:{to:"/project/list"}},[e._v("返回 - 项目列表\n        ")])],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"status"===e.type,expression:"type === 'status'"}]},[r("el-row",[r("el-col",{attrs:{span:4,offset:1}},[r("img",{staticStyle:{display:"block"},attrs:{src:a("992a"),alt:"device"}}),e._v(" "),r("p",[e._v("编号: "+e._s(e.deviceStatusObj.terminalId))]),e._v(" "),r("p",[e._v("\n            状态:\n            "),r("span",{staticClass:"text-primary"},[e._v(e._s(e.deviceStatusObj.online?"在线":"离线"))])])]),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right text-primary",attrs:{span:10}},[e._v("\n              磁盘容量\n            ")]),e._v(" "),r("el-col",{attrs:{span:12}},[e._v("\n               \n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:10}},[e._v("\n              可用:\n            ")]),e._v(" "),r("el-col",{attrs:{span:12}},[e._v("\n              "+e._s(e.deviceStatusObj.sdAvailableCapacity||"-")+" MB\n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:10}},[e._v("\n              总共:\n            ")]),e._v(" "),r("el-col",{attrs:{span:12}},[e._v("\n              "+e._s(e.deviceStatusObj.sdDiskCapacity||"-")+" MB\n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:10}},[e._v("\n              剩余可用:\n            ")]),e._v(" "),r("el-col",{attrs:{span:12}},[e._v("\n              "+e._s((100*e.deviceStatusObj.sdRemainingProportion).toFixed(2)||"-")+"%\n            ")])],1)],1),e._v(" "),r("el-col",{attrs:{span:10}},[r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:8}},[e._v("\n              当前配置文件:\n            ")]),e._v(" "),r("el-col",{staticClass:"world-break",attrs:{span:14}},[e._v("\n              "+e._s(e.deviceStatusObj.configurationFile||"-")+"\n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:8}},[e._v("\n              最新联网时间:\n            ")]),e._v(" "),r("el-col",{staticClass:"world-break",attrs:{span:14}},[e._v("\n              "+e._s(e.deviceStatusObj.networkTime||"-")+"\n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:8}},[e._v("\n              程序版本:\n            ")]),e._v(" "),r("el-col",{staticClass:"world-break",attrs:{span:14}},[e._v("\n              "+e._s(e.deviceStatusObj.version||"-")+"\n            ")])],1),e._v(" "),r("el-row",{staticClass:"mt20",attrs:{gutter:20}},[r("el-col",{staticClass:"text-right",attrs:{span:8}},[e._v("\n              设备负责人:\n            ")]),e._v(" "),r("el-col",{staticClass:"world-break",attrs:{span:14}},[e._v("\n              "+e._s(e.chargeUserName)+"\n            ")])],1)],1),e._v(" "),r("el-col",{staticClass:"text-right",attrs:{span:2}},[r("el-button",{staticClass:"full-width mt10",attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleRemoteRefresh}},[e._v("远程刷写\n          ")]),e._v(" "),r("br"),e._v(" "),r("el-button",{staticClass:"full-width mt10",attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleRemoteDiagnose}},[e._v("远程诊断\n          ")]),e._v(" "),r("br"),e._v(" "),r("el-button",{staticClass:"full-width mt10",attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleRestart}},[e._v("远程重启\n          ")]),e._v(" "),r("br"),e._v(" "),r("el-button",{staticClass:"full-width mt10",attrs:{type:"primary",size:"small",plain:""},on:{click:e.handleRemoteMonitor}},[e._v("远程监控\n          ")]),e._v(" "),r("br")],1),e._v(" "),r("el-col",{staticClass:"bottomLine"})],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"config"===e.type,expression:"type === 'config'"}]},[r("el-row",{staticClass:"mt10 mb20",attrs:{gutter:24}},[r("el-col",{attrs:{span:12}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleDelivery}},[e._v("下发配置文件\n          ")]),e._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索\n          ")]),e._v(" "),r("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置\n          ")])],1)],1),e._v(" "),r("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[r("el-form-item",{attrs:{label:"文件名称",prop:"fileName"}},[r("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入文件名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.fileName,callback:function(t){e.$set(e.queryParams,"fileName",t)},expression:"queryParams.fileName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作人",prop:"createUserId"}},[r("auto-complete",{ref:"autoInput",attrs:{width:"160px"},on:{autoValue:e.autoValue},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"下发时间",prop:"vin"}},[r("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.issuingTime,callback:function(t){e.issuingTime=t},expression:"issuingTime"}})],1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.configFileList}},[r("el-table-column",{attrs:{label:"序号",align:"center",prop:"id"}}),e._v(" "),r("el-table-column",{attrs:{label:"文件名称",align:"center",prop:"fileName","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"下发状态",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.filterEnum(t.row.status,e.statusOptions)||"-"))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作人",align:"center",prop:"createUserId","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"下发时间",align:"center",prop:"updateTime","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",width:"180","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.handleSendAgain(t.row)}}},[e._v("再次下发\n            ")]),e._v(" "),r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return e.handleDownload(t.row)}}},[e._v("下载\n            ")])]}}])})],1),e._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNo,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNo",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getDeviceInfo}})],1)],1),e._v(" "),e.refreshOpen?r("remote-refresh",{attrs:{id:e.projectId,visable:e.refreshOpen},on:{cancel:e.cancel,refresh:e.getDeviceInfo}}):e._e(),e._v(" "),e.diagnoseOpen?r("remote-diagnose",{attrs:{id:e.projectId,visable:e.diagnoseOpen},on:{cancel:e.cancel,refresh:e.getDeviceInfo}}):e._e(),e._v(" "),e.deliveryOpen?r("delivery-config",{attrs:{visable:e.deliveryOpen,"current-info":e.current_info},on:{cancel:e.cancel,refresh:e.getDeviceInfo}}):e._e()],1)},i=[],n=(a("c5f6"),a("435f")),l=a("8889"),o=a("f121"),s=a("7ca7"),c=a("03ea"),u=a("befe"),f=a("dfcf"),d=a("5b24"),m={name:"Remote",components:{RemoteRefresh:c["a"],RemoteDiagnose:u["a"],DeliveryConfig:f["a"],autoComplete:d["a"]},data:function(){return{projectId:Number(this.$route.params.projectId),allProjectList:[],cur_project:null,type:"status",loading:!1,total:0,configFileList:null,deviceStatusObj:{},statusOptions:this.ENUMS.CONFIGFILE_ISSUE,issuingTime:[],title:"",chargeUserName:void 0,current_info:null,refreshOpen:!1,diagnoseOpen:!1,deliveryOpen:!1,queryParams:{pageNo:1,pageSize:10,fileName:"",fileType:".img",createUserId:"",projectCode:void 0,deviceCode:void 0,projectId:void 0,id:void 0}}},watch:{},created:function(){var e=this;this.projectId=Number(this.$route.params.projectId),Object(s["d"])().then((function(t){if(t&&200===t.code){if(e.allProjectList=t.data,e.cur_project=e.allProjectList.filter((function(t){return t.projectId===e.projectId})),console.log("cur_project",e.cur_project),e.chargeUserName=e.cur_project[0].chargeUserName,e.queryParams.deviceCode=e.cur_project[0].deviceCode,!e.cur_project.length)return e.$message.error("此项目不存在！"),setTimeout((function(){e.$router.push("/project/list")}),800),!1;if(1!==e.cur_project[0].status)return e.$message.error("此项目不在进行中"),setTimeout((function(){e.$router.push("/project/list")}),800),!1;e.getDeviceInfo()}}))},methods:{handleChange:function(e){this.type=e},getDeviceInfo:function(){var e=this;this.loading=!0,Object(l["b"])(this.queryParams).then((function(t){t&&200===t.code&&(e.configFileList=t.data.list,e.total=t.data.total,e.loading=!1)})),Object(n["e"])(encodeURI(this.cur_project[0].deviceCode)).then((function(t){t&&200===t.code&&(e.deviceStatusObj=t.data)}))},handleQuery:function(){this.queryParams.pageNo=1,this.issuingTime.length?(this.queryParams.beginTime=this.issuingTime[0],this.queryParams.endTime=this.issuingTime[1]):(this.queryParams.beginTime="",this.queryParams.endTime=""),this.getDeviceInfo()},autoValue:function(e){this.queryParams.createUserId=e.userId},resetQuery:function(){this.$refs.autoInput.handleClear(),this.issuingTime=[],this.resetForm("queryForm"),this.handleQuery()},handleRemoteRefresh:function(){this.$router.push("/remote/refresh/".concat(this.cur_project[0].projectCode,"/").concat(this.cur_project[0].deviceCode))},handleRemoteDiagnose:function(){this.$router.push("/remote/diagnose/".concat(this.cur_project[0].projectCode,"/").concat(this.cur_project[0].deviceCode))},handleRestart:function(){var e=this;this.$confirm("是否确认远程重启?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={projectCode:e.cur_project[0].projectCode,deviceCode:e.cur_project[0].deviceCode};Object(l["d"])(t).then((function(t){console.log("res",t),t&&200===t.code?e.$message.success(t.data):e.$message.error("操作失败！")}))})).catch((function(){}))},handleRemoteMonitor:function(){this.$router.push({path:"/cockpit",name:"cockpit",query:{projectId:this.projectId}})},handleFormat:function(){this.$confirm("格式化后设备本地存储数据将被清除，请慎重操作！","注意：确认格式化SD卡？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){})).catch((function(){}))},handleDelivery:function(){var e=this;this.deliveryOpen=!0,this.current_info=JSON.parse(JSON.stringify(this.allProjectList.filter((function(t){return t.id==e.projectId}))[0]))},handleSendAgain:function(e){var t=this,a={configId:e.id};this.$confirm('是否再次下发文件名为"'+e.fileName+'"的配置文件?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["f"])(a).then((function(e){e&&200===e.code&&(t.msgSuccess("下发成功"),t.getDeviceInfo())}))})).catch((function(){}))},handleDownload:function(e){var t=o["a"].API_FILE+"/file/download?filePath=/config/"+e.deviceCode+"/&fileName="+e.fileName,a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="blob",a.onload=function(){var t=window.URL.createObjectURL(a.response),r=document.createElement("a");r.href=t,r.download=e.fileName,r.click(),document.body.removeChild(r)},a.send()},cancel:function(){this.refreshOpen=!1,this.diagnoseOpen=!1,this.deliveryOpen=!1,this.getDeviceInfo()},submitForm:function(){this.$refs["form"].validate((function(e){}))},handleDelete:function(e){var t=this;this.$confirm('是否确认删除车辆名称为"'+e.carName+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){delCar(e.id).then((function(e){e&&200===e.code&&(t.msgSuccess("删除成功"),t.getDeviceInfo())}))})).catch((function(){}))},filterEnum:function(e,t){return t[e]}}},p=m,h=(a("dfc1"),a("2877")),g=Object(h["a"])(p,r,i,!1,null,"38aa9b8a",null);t["default"]=g.exports},a325:function(e,t,a){"use strict";a("c636")},befe:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.visable,"close-on-click-modal":!1,"before-close":e.cancel,"append-to-body":"",width:"750px"},on:{"update:visible":function(t){e.visable=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"诊断类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.diagnoseOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"诊断文件",prop:"file"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择.zip文件",disabled:""},model:{value:e.form.file,callback:function(t){e.$set(e.form,"file",t)},expression:"form.file"}}),e._v(" "),a("upload",{attrs:{"file-type":"zip","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"file"},on:{getFile:e.getFile}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20,offset:1}},[a("el-form-item",{attrs:{label:"诊断方法",prop:"methods"}},[a("el-input",{staticStyle:{width:"78%"},attrs:{placeholder:"请选择.json文件",disabled:""},model:{value:e.form.methods,callback:function(t){e.$set(e.form,"methods",t)},expression:"form.methods"}}),e._v(" "),a("upload",{attrs:{"file-type":"json","limit-size":10,"bt-plain":!0,"bt-size":"medium","ipt-label":"methods"},on:{getFile:e.getFile}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)},i=[],n=(a("7f7f"),a("ac6a"),a("456d"),a("c5f6"),a("7d4e")),l={name:"RemoteDiagnose",components:{Upload:n["a"]},props:{visable:{default:!1,type:Boolean},id:{default:0,type:Number},currentInfo:{default:function(){return{}},type:Object}},data:function(){var e=this;return{title:"远程诊断",file:null,formData:new FormData,diagnoseOptions:Object.keys(this.ENUMS.DIAGNOSE_TYPE).map((function(t){return{value:t,label:e.ENUMS.DIAGNOSE_TYPE[t]}})),form:{},rules:{type:[{required:!0,message:"请选择诊断类型",trigger:"change"}],file:[{required:!0,message:"诊断文件不能为空",trigger:["blur","change"]}],methods:[{required:!0,message:"诊断方法不能为空",trigger:["blur","change"]}]}}},created:function(){this.reset()},methods:{getFile:function(e,t){t&&(this.form[t]=e.name)},submitForm:function(){this.$refs["form"].validate((function(e){}))},reset:function(){this.form={id:void 0,type:"",file:null,methods:null},this.resetForm("form")},cancel:function(){this.reset(),this.$emit("cancel")}}},o=l,s=a("2877"),c=Object(s["a"])(o,r,i,!1,null,"658522fa",null);t["a"]=c.exports},c0c7:function(e,t,a){"use strict";a.d(t,"h",(function(){return n})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"d",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"c",(function(){return f})),a.d(t,"f",(function(){return d})),a.d(t,"k",(function(){return m})),a.d(t,"l",(function(){return p})),a.d(t,"e",(function(){return h})),a.d(t,"g",(function(){return g})),a.d(t,"m",(function(){return v}));var r=a("b775"),i=(a("24bf"),a("f121"));function n(e){return Object(r["a"])({url:i["a"].API+"/user/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:i["a"].API+"/user/all",method:"get",params:e})}function o(e){return Object(r["a"])({url:i["a"].API+"/user/register",method:"post",data:e})}function s(e){return Object(r["a"])({url:i["a"].API+"/user/update",method:"put",data:e})}function c(e){return Object(r["a"])({url:i["a"].API+"/user/"+e,method:"delete"})}function u(e,t){var a={userId:e,password:t};return Object(r["a"])({url:i["a"].API+"/user/reset-pwd",method:"put",data:a})}function f(e,t){return Object(r["a"])({url:i["a"].API+"/user/"+e+"/"+t,method:"put"})}function d(){return Object(r["a"])({url:i["a"].API+"/user/info",method:"get"})}function m(e,t,a){var n={username:e,oldPassword:t,newPassword:a};return Object(r["a"])({url:i["a"].API+"/user/pwd",method:"put",data:n})}function p(e){return Object(r["a"])({url:i["a"].API+"/system/user/profile/avatar",method:"post",data:e})}function h(){return Object(r["a"])({url:i["a"].API_MONIT+"/device/duty-decide-list",method:"get"})}function g(){return Object(r["a"])({url:i["a"].API_MONIT+"/project/duty-project-list",method:"get"})}function v(e){return Object(r["a"])({url:i["a"].API+"/user/search",method:"get",params:e})}},c636:function(e,t,a){},dfc1:function(e,t,a){"use strict";a("4d9e")},dfcf:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.visable,"close-on-click-modal":!1,"before-close":e.cancel,"append-to-body":"",width:"1150px"},on:{"update:visible":function(t){e.visable=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:11}},[a("el-col",[a("el-form-item",{attrs:{label:"当前配置文件"}},[e.deviceLastInfo?a("span",[e._v(e._s(e.deviceLastInfo.fileName||"--"))]):e._e()])],1),e._v(" "),a("el-col",[a("el-form-item",{staticClass:"form-btLine",attrs:{label:"下发时间"}},[e.deviceLastInfo?a("span",[e._v(e._s(e.deviceLastInfo.time||"--"))]):e._e()])],1),e._v(" "),a("el-col",[a("el-form-item",{staticClass:"mt20",attrs:{label:"配置文件",prop:"fileName"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"80px"}},[a("el-form-item",{attrs:{label:"选择文件"}},[a("el-button",{attrs:{size:"small",type:"primary",plain:"",disabled:!0},on:{click:function(t){return e.openRight("file","选择文件",e.fileTotal)}}},[e._v("文件库选择")]),e._v(" "),a("upload",{attrs:{"file-type":"img","limit-size":10,"bt-content":"本地电脑选择","bt-plain":!0},on:{getFile:e.getFile}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",disabled:!0,plain:""},on:{click:function(t){return e.openRight("file","历史文件",e.fileTotal)}}},[e._v("历史记录选择")])],1)],1)],1),e._v(" "),e.rightFlag?a("el-col",{staticClass:"right-wrap",attrs:{span:13}},[a("p",{staticClass:"rightTitle"},[e._v(e._s(e.rightTitle))]),e._v(" "),"file"===e.rightFlag?a("el-form",{ref:"queryParams_file",attrs:{model:e.queryParams_file,inline:!0}},[a("el-form-item",{attrs:{label:"文件名称",prop:"fileName"}},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"请输入文件名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams_file.fileName,callback:function(t){e.$set(e.queryParams_file,"fileName",t)},expression:"queryParams_file.fileName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search",plain:""},on:{click:e.handleQuery}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirmSelect}},[e._v("确定")])],1)],1):e._e(),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"file"===e.rightFlag,expression:"rightFlag === 'file'"}],attrs:{data:e.fileList,height:"264"}},[a("el-table-column",{attrs:{label:"选择",align:"center",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.$index},nativeOn:{change:function(a){return e.getCurrentRow(t.row)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" ")])]}}],null,!1,2694489770)}),e._v(" "),a("el-table-column",{attrs:{label:"文件名称",align:"center",prop:"fileName","show-overflow-tooltip":""}})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.rightTotal>0,expression:"rightTotal > 0"}],attrs:{total:e.rightTotal,page:e.rightParams.pageNo,limit:e.rightParams.pageSize},on:{"update:page":function(t){return e.$set(e.rightParams,"pageNo",t)},"update:limit":function(t){return e.$set(e.rightParams,"pageSize",t)},pagination:e.freshData}})],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)},i=[],n=(a("7f7f"),a("8889")),l=a("7d4e"),o={name:"DeliveryConfig",components:{Upload:l["a"]},props:{visable:{default:!1,type:Boolean},currentInfo:{default:function(){return{}},type:Object}},data:function(){return{loading:!1,deviceLastInfo:null,title:"下发配置文件",fData:{},isLocal:!1,file:null,formData:new FormData,fileList:null,fileTotal:0,radio:"",currentSelect:null,form:{id:0,fileName:"",filePath:"",fileType:"",deviceCode:"",projectCode:""},rules:{fileName:[{required:!0,message:"配置文件不能为空",trigger:"change"}]},rightParams:null,queryParams_file:{pageNo:1,pageSize:10,fileName:"",createUserId:"",beginTime:"",endTime:""},rightFlag:"",rightTitle:"",rightTotal:0}},watch:{},created:function(){if(this.reset(),this.queryDeviceLastInfo(),this.getFileList(),this.currentInfo&&this.currentInfo.id){var e=JSON.parse(JSON.stringify(this.currentInfo));console.log("current_info",e),this.form.id=e.id}},methods:{getFileList:function(e){var t=this;Object(n["b"])(this.queryParams_file).then((function(a){console.log("res :>> ",a),a&&200===a.code&&(t.fileList=a.data.list,t.fileTotal=a.data.total,"query"===e&&(t.rightTotal=t.fileTotal))}))},queryDeviceLastInfo:function(){var e=this,t={deviceCode:encodeURI(this.currentInfo.deviceCode)};Object(n["c"])(t).then((function(t){t&&200===t.code&&(e.deviceLastInfo=t.data)}))},getFile:function(e){console.log("file :>> ",e),e&&(this.isLocal=!0,this.file=e,this.formData.set("file",e),this.formData.set("remark","file"),this.formData.set("path","config"),this.form.fileName=e.name)},openRight:function(e,t,a){switch(this.rightFlag=e,this.rightTitle=t,this.rightTotal=a,this.rightFlag){case"file":this.rightParams=this.queryParams_file;break}},freshData:function(e){switch(this.rightFlag){case"file":this.getFileList(e);break}},handleQuery:function(){this.rightParams.pageNo=1,this.freshData("query"),this.currentSelect=null,this.radio=""},getCurrentRow:function(e){console.log(e,"this.currentSelect.."),this.currentSelect=e},confirmSelect:function(){if(null===this.currentSelect)return this.$message.warning("请选择"),!1;switch(this.rightFlag){case"file":this.form.fileName=this.currentSelect.fileName,this.form.filePath=this.currentSelect.filePath,this.form.fileType=this.currentSelect.fileType,this.form.deviceCode=this.currentSelect.deviceCode,this.form.projectCode=this.currentSelect.projectCode;break}this.currentSelect=null,this.radio="",this.rightFlag=""},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(e.isLocal?(e.isLocal=!1,e.loading=!0,e.formData.set("path","config/"+e.currentInfo.deviceCode),Object(n["g"])(e.formData).then((function(t){t&&200===t.code?(e.loading=!1,e.form.fileName=t.data.fileName,e.form.filePath=t.data.filePath,e.form.fileType=t.data.fileType,e.form.fileSize=t.data.fileSize,e.form.deviceCode=e.currentInfo.deviceCode,e.form.projectCode=e.currentInfo.projectCode,Object(n["e"])(e.form).then((function(t){200===t.code&&(e.msgSuccess("配置文件下发成功"),e.cancel())})).catch((function(t){console.log("err=====>",t),e.loading=!1,e.$message.error("文件下发失败，原因："+t.data.message)}))):e.$message.error("文件上传失败，请重新操作！")}))):Object(n["e"])(e.form).then((function(t){200===t.code?(e.msgSuccess("配置文件下发成功"),e.cancel()):e.$message.error("文件下发失败，请重新操作！")})).catch((function(t){console.log("err=====>",t),e.$message.error("文件下发失败，原因："+t.data.message)})))}))},reset:function(){this.form={id:0,fileName:"",filePath:""},this.resetForm("form")},cancel:function(){this.reset(),this.$emit("cancel")}}},s=o,c=(a("a325"),a("2877")),u=Object(c["a"])(s,r,i,!1,null,"7ab70796",null);t["a"]=u.exports}}]);