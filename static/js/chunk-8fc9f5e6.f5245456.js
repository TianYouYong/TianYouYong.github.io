(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8fc9f5e6"],{"1e8b":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-row",{attrs:{gutter:16}},[r("el-row",{staticClass:"userInfo_wrap mt10 mb20",attrs:{type:"flex",justify:"center"}},[r("el-col",{staticClass:"userInfo_item flex-center",attrs:{span:6}},[r("userAvatar",{attrs:{user:t.user}})],1),t._v(" "),r("el-col",{staticClass:"userInfo_item",attrs:{span:9}},[r("el-row",{staticClass:"mt10"}),t._v(" "),r("el-row",{staticClass:"mt20 mb20",attrs:{gutter:0}},[r("el-col",{staticClass:"text-info",attrs:{span:5,offset:2}},[t._v("用户姓名：")]),t._v(" "),r("el-col",{staticClass:"text-muted",attrs:{span:10}},[t._v(t._s(t.user.userName))])],1),t._v(" "),r("el-row",{staticClass:"mb20",attrs:{gutter:0}},[r("el-col",{staticClass:"text-info",attrs:{span:5,offset:2}},[t._v("手机号码：")]),t._v(" "),r("el-col",{staticClass:"text-muted",attrs:{span:10}},[t._v(t._s(t.user.phone))])],1),t._v(" "),r("el-row",{staticClass:"mb20",attrs:{gutter:0}},[r("el-col",{staticClass:"text-info",attrs:{span:5,offset:2}},[t._v("归属机构：")]),t._v(" "),r("el-col",{staticClass:"text-muted",attrs:{span:10}},[t._v(t._s(t.user.orgName))])],1),t._v(" "),r("el-row",{attrs:{gutter:0}},[r("el-col",{staticClass:"text-info",attrs:{span:5,offset:2}},[t._v("角色名称：")]),t._v(" "),r("el-tooltip",{attrs:{disabled:t.hideTooltip,content:t.user.rolesNames,placement:"top"}},[r("el-col",{staticClass:"text-muted",attrs:{span:10}},[r("span",{ref:"rolesNames",staticClass:"rolesNames text-ellipsis"},[t._v(t._s(t.user.rolesNames))])])],1)],1)],1),t._v(" "),r("el-col",{staticClass:"userInfo_item flex-center",attrs:{span:3}},[r("el-link",{attrs:{type:"danger"},on:{click:t.logout}},[t._v("退出登录")])],1)],1),t._v(" "),r("el-row",[r("el-col",{staticClass:"bottomLine"})],1),t._v(" "),r("el-row",{staticClass:"center_line",attrs:{gutter:10}},[r("el-col",{staticClass:"fuze",attrs:{span:12}},[r("p",{staticClass:"text-primary ml30"},[t._v("负责设备")]),t._v(" "),r("div",t._l(t.deviceList,(function(e,s){return r("el-col",{key:s,staticClass:"mb20",attrs:{offset:2}},[r("span",{staticClass:"text-info"},[t._v("设备号：")]),t._v(" "),r("span",{staticClass:"text-muted"},[t._v(t._s(e.deviceCode)+"【"+t._s(t._f("formatDeviceStatus")(e.status))+"】")])])})),1)]),t._v(" "),r("el-col",{staticClass:"fuze",attrs:{span:12}},[r("p",{staticClass:"text-primary ml30"},[t._v("负责项目")]),t._v(" "),r("div",t._l(t.projectList,(function(e,s){return r("el-col",{key:s,staticClass:"mb20",attrs:{offset:2}},[r("span",{staticClass:"text-info"},[t._v("项目号：")]),t._v(" "),r("span",{staticClass:"text-muted"},[t._v(t._s(e.projectCode)+"【"+t._s(t._f("formatProjectStatus")(e.status))+"】")])])})),1)])],1)],1)],1)},o=[],a=(r("96cf"),r("1da1")),n=r("c0c7"),i=r("9429"),l={components:{userAvatar:i["default"]},props:{user:{type:Object}},data:function(){return{deviceList:[],projectList:[],hideTooltip:!0,erd:null}},mounted:function(){var t=this,e=r("eec4");this.erd=e(),this.$refs.rolesNames&&this.erd.listenTo(this.$refs.rolesNames,(function(e){var r=e.offsetWidth;r>=260&&(t.hideTooltip=!1)}))},created:function(){this.getDeviceProject()},beforeDestroy:function(){this.erd.uninstall(this.$refs.rolesNames)},methods:{logout:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认退出登录？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$store.dispatch("LogOut").then((function(t){e.$router.push("/login")}))}));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getDeviceProject:function(){var t=this;Object(n["e"])().then((function(e){e&&200===e.code&&(t.deviceList=e.data)})),Object(n["g"])().then((function(e){e&&200===e.code&&(t.projectList=e.data)}))}}},c=l,u=(r("e692"),r("2877")),f=Object(u["a"])(c,s,o,!1,null,"7d12f7dc",null);e["default"]=f.exports},"42e8":function(t,e,r){},"4c1b":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-row",{attrs:{gutter:24}},[r("el-row",{staticClass:"headerBtnLine",attrs:{gutter:24}},[r("el-col",{staticClass:"clearfix"},[r("el-button",{attrs:{type:"primary",size:"mini",plain:"personInfo"!==t.activeTab},on:{click:function(e){return t.handleChange("personInfo")}}},[t._v("个人资料")]),t._v(" "),r("el-button",{attrs:{type:"primary",size:"mini",plain:"resetPass"!==t.activeTab},on:{click:function(e){return t.handleChange("resetPass")}}},[t._v("重置密码")]),t._v(" "),r("router-link",{staticClass:"pull-right mt10 mr20 go-back",attrs:{to:"/home"}},[r("el-link",{attrs:{type:"primary"}},[t._v("返回")])],1)],1)],1),t._v(" "),"personInfo"===t.activeTab?r("div",[r("userInfo",{attrs:{user:t.user}})],1):t._e(),t._v(" "),"resetPass"===t.activeTab?r("div",[r("resetPwd",{attrs:{user:t.user}})],1):t._e()],1)],1)},o=[],a=r("1e8b"),n=r("ee46"),i=r("c0c7"),l={name:"Profile",components:{userInfo:a["default"],resetPwd:n["default"]},data:function(){return{user:{},roleGroup:{},postGroup:{},activeTab:"personInfo"}},created:function(){this.getUser()},methods:{getUser:function(){var t=this;Object(i["f"])().then((function(e){t.user=e.data}))},handleChange:function(t){this.activeTab=t}}},c=l,u=r("2877"),f=Object(u["a"])(c,s,o,!1,null,null,null);e["default"]=f.exports},9429:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("img",{staticClass:"img-circle img-lg",attrs:{src:t.options.img,title:"点击上传头像"},on:{click:function(e){return t.editCropper()}}}),t._v(" "),r("el-dialog",{attrs:{title:t.title,visible:t.open,width:"900px","append-to-body":""},on:{"update:visible":function(e){t.open=e},opened:t.modalOpened}},[r("el-row",{attrs:{gutter:0}},[r("el-col",{style:{height:"350px"},attrs:{xs:12,sm:12,md:12}},[t.visible?r("vue-cropper",{ref:"cropper",attrs:{img:t.options.img,info:!0,autoCrop:t.options.autoCrop,autoCropWidth:t.options.autoCropWidth,autoCropHeight:t.options.autoCropHeight,fixedBox:t.options.fixedBox},on:{realTime:t.realTime}}):t._e()],1),t._v(" "),r("el-col",{style:{height:"350px"},attrs:{xs:12,sm:12,md:12}},[r("div",{staticClass:"avatar-upload-preview"},[r("img",{style:t.previews.img,attrs:{src:t.previews.url}})])])],1),t._v(" "),r("br"),t._v(" "),r("el-row",[r("el-col",{attrs:{lg:2,md:2}},[r("el-upload",{attrs:{action:"#","http-request":t.requestUpload,"show-file-list":!1,"before-upload":t.beforeUpload}},[r("el-button",{attrs:{size:"small"}},[t._v("\n            上传\n            "),r("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1),t._v(" "),r("el-col",{attrs:{lg:{span:1,offset:2},md:2}},[r("el-button",{attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(e){return t.changeScale(1)}}})],1),t._v(" "),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-minus",size:"small"},on:{click:function(e){return t.changeScale(-1)}}})],1),t._v(" "),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-refresh-left",size:"small"},on:{click:function(e){return t.rotateLeft()}}})],1),t._v(" "),r("el-col",{attrs:{lg:{span:1,offset:1},md:2}},[r("el-button",{attrs:{icon:"el-icon-refresh-right",size:"small"},on:{click:function(e){return t.rotateRight()}}})],1),t._v(" "),r("el-col",{attrs:{lg:{span:2,offset:6},md:2}},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.uploadImg()}}},[t._v("提 交")])],1)],1)],1)],1)},o=[],a=r("4360"),n=r("7e79"),i=r("c0c7"),l={components:{VueCropper:n["VueCropper"]},props:{user:{type:Object}},data:function(){return{open:!1,visible:!1,title:"修改头像",options:{img:a["a"].getters.avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{editCropper:function(){this.open=!0},modalOpened:function(){this.visible=!0},requestUpload:function(){},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},changeScale:function(t){t=t||1,this.$refs.cropper.changeScale(t)},beforeUpload:function(t){var e=this;if(-1==t.type.indexOf("image/"))this.msgError("文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。");else{var r=new FileReader;r.readAsDataURL(t),r.onload=function(){e.options.img=r.result}}},uploadImg:function(){var t=this;this.$refs.cropper.getCropBlob((function(e){var r=new FormData;r.append("avatarfile",e),Object(i["l"])(r).then((function(e){200===e.code&&(t.open=!1,t.options.img="http://180.76.54.21:8899/api"+e.imgUrl,a["a"].commit("SET_AVATAR",t.options.img),t.msgSuccess("修改成功")),t.visible=!1}))}))},realTime:function(t){this.previews=t}}},c=l,u=r("2877"),f=Object(u["a"])(c,s,o,!1,null,null,null);e["default"]=f.exports},c0c7:function(t,e,r){"use strict";r.d(e,"h",(function(){return a})),r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),r.d(e,"j",(function(){return l})),r.d(e,"d",(function(){return c})),r.d(e,"i",(function(){return u})),r.d(e,"c",(function(){return f})),r.d(e,"f",(function(){return d})),r.d(e,"k",(function(){return p})),r.d(e,"l",(function(){return m})),r.d(e,"e",(function(){return v})),r.d(e,"g",(function(){return h})),r.d(e,"m",(function(){return g}));var s=r("b775"),o=(r("24bf"),r("f121"));function a(t){return Object(s["a"])({url:o["a"].API+"/user/list",method:"get",params:t})}function n(t){return Object(s["a"])({url:o["a"].API+"/user/all",method:"get",params:t})}function i(t){return Object(s["a"])({url:o["a"].API+"/user/register",method:"post",data:t})}function l(t){return Object(s["a"])({url:o["a"].API+"/user/update",method:"put",data:t})}function c(t){return Object(s["a"])({url:o["a"].API+"/user/"+t,method:"delete"})}function u(t,e){var r={userId:t,password:e};return Object(s["a"])({url:o["a"].API+"/user/reset-pwd",method:"put",data:r})}function f(t,e){return Object(s["a"])({url:o["a"].API+"/user/"+t+"/"+e,method:"put"})}function d(){return Object(s["a"])({url:o["a"].API+"/user/info",method:"get"})}function p(t,e,r){var a={username:t,oldPassword:e,newPassword:r};return Object(s["a"])({url:o["a"].API+"/user/pwd",method:"put",data:a})}function m(t){return Object(s["a"])({url:o["a"].API+"/system/user/profile/avatar",method:"post",data:t})}function v(){return Object(s["a"])({url:o["a"].API_MONIT+"/device/duty-decide-list",method:"get"})}function h(){return Object(s["a"])({url:o["a"].API_MONIT+"/project/duty-project-list",method:"get"})}function g(t){return Object(s["a"])({url:o["a"].API+"/user/search",method:"get",params:t})}},e692:function(t,e,r){"use strict";r("42e8")},ee46:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("br"),r("br"),t._v(" "),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-col",{attrs:{span:8}},[r("el-form",{ref:"form",attrs:{model:t.user,rules:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[r("el-input",{attrs:{placeholder:"请输入旧密码",type:"password"},model:{value:t.user.oldPassword,callback:function(e){t.$set(t.user,"oldPassword","string"===typeof e?e.trim():e)},expression:"user.oldPassword"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[r("el-input",{attrs:{placeholder:"请输入新密码",type:"password",autocomplete:"off"},model:{value:t.user.newPassword,callback:function(e){t.$set(t.user,"newPassword","string"===typeof e?e.trim():e)},expression:"user.newPassword"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[r("el-input",{attrs:{placeholder:"请确认密码",type:"password",autocomplete:"off"},model:{value:t.user.confirmPassword,callback:function(e){t.$set(t.user,"confirmPassword","string"===typeof e?e.trim():e)},expression:"user.confirmPassword"}})],1),t._v(" "),r("el-form-item",{staticClass:"text-center"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submit}},[t._v("确认")])],1)],1)],1)],1)],1)},o=[],a=(r("7f7f"),r("c0c7")),n=r("a78e"),i=r.n(n),l={data:function(){var t=this,e=function(e,r,s){r?(t.user.newPassword&&t.$refs.form.validateField("newPassword"),s()):s(new Error("旧密码不能为空"))},r=function(e,r,s){r?(t.user.oldPassword&&r===t.user.oldPassword?s(new Error("输入的新密码与旧密码相同")):t.user.confirmPassword&&t.$refs.form.validateField("confirmPassword"),s()):s(new Error("新密码不能为空"))},s=function(e,r,s){r?(r!==t.user.newPassword&&s(new Error("两次输入密码不一致")),s()):s(new Error("确认密码不能为空"))};return{user:{oldPassword:void 0,newPassword:void 0,confirmPassword:void 0},rules:{oldPassword:[{validator:e,trigger:"blur"}],newPassword:[{validator:r,trigger:"blur"}],confirmPassword:[{validator:s,trigger:"blur"}]}}},methods:{submit:function(){var t=this;this.$refs["form"].validate((function(e){e&&Object(a["k"])(t.$store.getters.name,t.user.oldPassword,t.user.newPassword).then((function(e){e&&200===e.code&&(t.msgSuccess("修改成功"),t.$store.dispatch("LogOut").then((function(e){t.$router.push("/login"),i.a.remove("password")})))})).catch((function(e){console.log("err :>> ",e),t.msgError(e.data.message||"修改失败！")}))}))}}},c=l,u=r("2877"),f=Object(u["a"])(c,s,o,!1,null,null,null);e["default"]=f.exports}}]);